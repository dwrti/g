name: Video Uploader to Catbox

on:
  workflow_dispatch:
    inputs:
      video_url:
        description: 'ุถุน ุฑุงุจุท ุงูููุทุน ููุง'
        required: true
      file_name:
        description: 'ุงูุชุจ ุงุณู ุงูููู (ุณูุชู ุชูุธููู ุชููุงุฆูุงู)'
        required: true

jobs:
  catbox_upload:
    runs-on: ubuntu-latest
    steps:
      - name: Download and Upload to Catbox
        run: |
          # 1. ุชุฌููุฒ ุงุณู ุงูููู ูุชูุธููู ูู ุงููุณุงูุงุช
          # tr ' ' '_' ูุจุฏู ุงููุณุงูุงุช ุจุดุฑุทุฉ ุณูููุฉ ุนุดุงู ูุง ูุบูุท ุงูููุฏ
          SAFE_NAME=$(echo "${{ github.event.inputs.file_name }}" | sed 's/\.mp4//g' | tr ' ' '_')
          FINAL_FILE="${SAFE_NAME}.mp4"

          echo "๐ ุฌุงุฑู ุชุญููู ุงูููุทุน ุจุงุณู: $FINAL_FILE"

          # 2. ุชุญููู ุงูููุทุน ูู ุงูุฑุงุจุท ุงูุฃุตูู
          curl -L "${{ github.event.inputs.video_url }}" -o "$FINAL_FILE"

          # 3. ุงูุฑูุน ุฅูู Catbox
          echo "๐ค ุฌุงุฑู ุงูุฑูุน ุฅูู Catbox..."
          # Catbox ูุนูุฏ ุงูุฑุงุจุท ูุจุงุดุฑุฉ ูู text ูููุณ JSON
          URL=$(curl -F "reqtype=fileupload" -F "fileToUpload=@$FINAL_FILE" https://catbox.moe/user/api.php)

          # 4. ุงููุชูุฌุฉ ุงูููุงุฆูุฉ
          echo "--------------------------------------------------"
          echo "โ ุชู ุงูุฑูุน ุจูุฌุงุญ ูุง ุจุทู!"
          echo "๐ ุฑุงุจุท ุงููุดุงูุฏุฉ ุงููุจุงุดุฑ: $URL"
          echo "--------------------------------------------------"
