name: Ultimate Video Uploader (Pixeldrain)

on:
  workflow_dispatch:
    inputs:
      video_url:
        description: 'Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ'
        required: true
      file_name:
        description: 'Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù'
        required: true

jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
      - name: Transfer
        run: |
          # 1. ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù…
          SAFE_NAME=$(echo "${{ github.event.inputs.file_name }}" | sed 's/\.mp4//g' | tr ' ' '_').mp4

          # 2. Ø§Ù„ØªØ­Ù…ÙŠÙ„
          echo "â¬‡ï¸ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø·Ø¹..."
          curl -kL "${{ github.event.inputs.video_url }}" -o "$SAFE_NAME"

          # 3. Ø§Ù„Ø±ÙØ¹ Ø¥Ù„Ù‰ Pixeldrain
          echo "ğŸ“¤ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹ Ø¥Ù„Ù‰ Pixeldrain..."
          # Ø§Ù„Ø±ÙØ¹ ÙŠØ¹ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„Ù€ File ID ÙÙŠ JSON
          RESPONSE=$(curl -k -T "$SAFE_NAME" https://pixeldrain.com/api/file/)
          FILE_ID=$(echo $RESPONSE | jq -r '.id')

          # 4. Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
          echo "--------------------------------------------------"
          echo "âœ… ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!"
          echo "ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©: https://pixeldrain.com/u/$FILE_ID"
          echo "ğŸ¬ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ù…Ø´ØºÙ„): https://pixeldrain.com/api/file/$FILE_ID?download"
          echo "--------------------------------------------------"
